(this["webpackJsonpihearu-client"]=this["webpackJsonpihearu-client"]||[]).push([[0],{407:function(e,n,t){},414:function(e,n,t){},420:function(e,n){},421:function(e,n){},429:function(e,n){},439:function(e,n){},440:function(e,n){},441:function(e,n){},449:function(e,n){},521:function(e,n,t){"use strict";t.r(n);var r=t(11),a=t.n(r),c=t(64),o=t.n(c),i=(t(407),t(4)),s=t.n(i),l=t(12),u=t(5),d=t(135),h=(t(414),t(364)),f=t.n(h),p=t(563),j=t(564),b=t(287),g=t(559),x=t(390),m=t.n(x),v=t(561),O=t(566),w=t(560),k=t(555),y=t(556),S=t(554),C=t(567),W=t(558),A=t(568),L=t(195),N={settings:{threshold:85,showStats:!1,speakAlong:!0},sentence:{predictions:[],words:[],log:[]}},H=Object(L.b)({name:"settings",initialState:N.settings,reducers:{setThreshold:function(e,n){e.threshold=n.payload},setShowStats:function(e,n){e.showStats=n.payload},setSpeakAlong:function(e,n){e.speakAlong=n.payload}}}),T=Object(L.b)({name:"sentence",initialState:N.sentence,reducers:{addPrediction:function(e,n){e.predictions.push(n.payload)},addWord:function(e,n){e.predictions=[],e.words.push(n.payload)},logWords:function(e){e.log.unshift(e.words),e.words=[]}}}),F=(H.reducer,Object(L.a)({reducer:{settings:H.reducer,sentence:T.reducer}})),P=F.getState,U=F.dispatch,E=t(557),I=t(42);function R(e){return"".concat(e,"%")}function B(e){var n=e.open,t=e.handleClose,r=Object(d.c)((function(e){return e.settings})),a=Object(d.b)();return Object(I.jsx)("div",{children:Object(I.jsxs)(O.a,{fullWidth:!0,maxWidth:"sm",open:n,onClose:t,"aria-labelledby":"settings-dialog-title",children:[Object(I.jsx)(S.a,{id:"settings-dialog-title",children:"Settings"}),Object(I.jsx)(k.a,{children:Object(I.jsx)(y.a,{children:Object(I.jsxs)(E.a,{children:[Object(I.jsx)(W.a,{control:Object(I.jsx)(C.a,{value:r.threshold,getAriaValueText:R,"aria-labelledby":"threshold-slider",valueLabelDisplay:"auto",step:5,marks:!0,min:50,max:99,onChange:function(e,n){return a(H.actions.setThreshold(n))}}),label:"Accuracy threshold",labelPlacement:"top"}),Object(I.jsx)(W.a,{control:Object(I.jsx)(A.a,{checked:r.showStats,onChange:function(e){return a(H.actions.setShowStats(e.target.checked))},name:"showStats",color:"primary"}),label:"Show Stats"}),Object(I.jsx)(W.a,{control:Object(I.jsx)(A.a,{checked:r.speakAlong,onChange:function(e){return a(H.actions.setSpeakAlong(e.target.checked))},name:"showStats",color:"primary"}),label:"Speak along signing"})]})})}),Object(I.jsx)(w.a,{children:Object(I.jsx)(v.a,{autoFocus:!0,onClick:t,color:"primary",children:"Close"})})]})})}var D,z,J=t(20),M=t(388),V=t(387),$=t(285),q=[],G=[],K=[],Q=[],X=[],Y=new Array(63).fill(0),Z=function(e){return e.reduce((function(e,n){return e.concat([n.x,n.y,n.z])}),[])};function _(){return ee.apply(this,arguments)}function ee(){return(ee=Object(l.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"model/model.json",e.next=3,$.a("model/model.json");case 3:D=e.sent;case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ne(){return te.apply(this,arguments)}function te(){return(te=Object(l.a)(s.a.mark((function e(){var n,t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/model.csv");case 2:return n=e.sent,e.next=5,n.text();case 5:return t=e.sent,q=t.split(","),e.next=9,re();case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function re(){return ae.apply(this,arguments)}function ae(){return(ae=Object(l.a)(s.a.mark((function e(){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/franco.json");case 2:return n=e.sent,e.next=5,n.json();case 5:z=e.sent;case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ce(e){return oe.apply(this,arguments)}function oe(){return(oe=Object(l.a)(s.a.mark((function e(n){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new V.Hands({locateFile:function(e){return"/hands/".concat(e)}})).setOptions({maxNumHands:2,minDetectionConfidence:.5,minTrackingConfidence:.5}),t.onResults(ie),e.next=5,t.initialize();case 5:n&&new M.Camera(n,{onFrame:function(){var e=Object(l.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.send({image:n});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}).start();case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ie(e){if(function(e){if(e.multiHandLandmarks&&e.multiHandedness){for(var n=Y,t=Y,r=0;r<e.multiHandLandmarks.length;r++){var a="Right"===e.multiHandedness[r].label,c=e.multiHandLandmarks[r];a?t=Z(c):n=Z(c)}G=[].concat(Object(J.a)(n),Object(J.a)(t)),K.push(G)}}(e),2===K.length){var n=function(e){var n=$.b([e]),t=D.predict(n).dataSync(),r=Math.max.apply(Math,Object(J.a)(t)),a=Object(J.a)(t).indexOf(r);return r>=P().settings.threshold/100?(console.log(q[a],r),q[a]):null}(K),t=n!==X[X.length-1],r=Q.length>4&&n===(a=Q).sort((function(e,n){return a.filter((function(n){return n===e})).length-a.filter((function(e){return e===n})).length})).pop();if(n&&(Q.push(n),U(T.actions.addPrediction(n))),n&&t&&r)X.push(n),Q=[],U(T.actions.addWord(n)),P().settings.speakAlong&&speechSynthesis.speak(new SpeechSynthesisUtterance(z[n]));K=[]}var a}function se(){var e=P().sentence.words.map((function(e){return z[e]}));speechSynthesis.speak(new SpeechSynthesisUtterance(e.join(" "))),U(T.actions.logWords()),X=[]}function le(e){return e.reduce((function(e,n){return n in e?e[n]++:e[n]=1,e}),{})}var ue=t(565),de=t(391),he=t.n(de),fe=t(562),pe=t(392),je=t(389),be=t.n(je),ge=Object(pe.a)({palette:{primary:{light:"#ffce42",main:"#ffbd00",dark:"#bd8c00",contrastText:"#fff"}}});var xe=function(){var e=Object(r.useRef)(null),n=a.a.useState(!1),t=Object(u.a)(n,2),c=t[0],o=t[1],i=a.a.useState(!0),h=Object(u.a)(i,2),x=h[0],v=h[1],O=Object(d.c)((function(e){return e.settings})),w=Object(d.c)((function(e){return e.sentence}));return Object(r.useEffect)((function(){(function(){var n=Object(l.a)(s.a.mark((function n(){var t,r;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,ne();case 2:return n.next=4,_();case 4:if(!(null===(t=e.current)||void 0===t?void 0:t.video)){n.next=7;break}return n.next=7,ce(null===(r=e.current)||void 0===r?void 0:r.video);case 7:v(!1);case 8:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}})()()}),[]),Object(I.jsxs)(fe.a,{theme:ge,children:[Object(I.jsx)(p.a,{position:"static",children:Object(I.jsxs)(j.a,{className:"appbar-toolbar",children:[Object(I.jsxs)("div",{className:"appbar-toolbar--title",children:[Object(I.jsx)("img",{src:"/favicon.ico",alt:"logo"}),Object(I.jsx)(b.a,{variant:"h6",children:"IHearU"})]}),Object(I.jsx)(g.a,{edge:"end","aria-label":"settings","aria-haspopup":"true",color:"inherit",onClick:function(){o(!0)},children:Object(I.jsx)(m.a,{})})]})}),!x&&O.showStats&&Object(I.jsx)("div",{className:"stats",children:Object(I.jsx)("div",{children:Object.keys(le(w.predictions)).map((function(e){return Object(I.jsxs)("span",{children:[e,": ",le(w.predictions)[e]," "]},e)}))})}),Object(I.jsx)(f.a,{ref:e,style:{display:x?"none":"block"}}),Object(I.jsx)(B,{open:c,handleClose:function(){o(!1)}}),x&&Object(I.jsxs)("div",{className:"loading-scrim",children:[Object(I.jsx)("img",{src:"/logo192.png",alt:"IHearU Logo",className:"App-logo"}),Object(I.jsx)("h3",{children:"Loading detection models"}),Object(I.jsx)(ue.a,{})]}),Object(I.jsxs)("div",{className:"typewriter-container",children:[Object(I.jsx)(be.a,{typing:1,children:w.words.join(" ")}),Object(I.jsx)(g.a,{edge:"end","aria-label":"settings","aria-haspopup":"true",color:"primary",onClick:se,disabled:0===w.words.length,children:Object(I.jsx)(he.a,{})})]}),Object(I.jsx)("div",{className:"word-log",children:w.log.map((function(e,n){return Object(I.jsxs)("p",{children:[e.join(" ")," "]},"".concat(e,"-").concat(n))}))})]})},me=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ve(e,n){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),n&&n.onUpdate&&n.onUpdate(e)):(console.log("Content is cached for offline use."),n&&n.onSuccess&&n.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var Oe=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,569)).then((function(n){var t=n.getCLS,r=n.getFID,a=n.getFCP,c=n.getLCP,o=n.getTTFB;t(e),r(e),a(e),c(e),o(e)}))};o.a.render(Object(I.jsx)(d.a,{store:F,children:Object(I.jsx)(xe,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var n="".concat("","/service-worker.js");me?(!function(e,n){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(t){var r=t.headers.get("content-type");404===t.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):ve(e,n)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(n,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):ve(n,e)}))}}(),Oe()}},[[521,1,2]]]);
//# sourceMappingURL=main.58e2a2be.chunk.js.map