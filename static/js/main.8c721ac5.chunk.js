(this["webpackJsonpihearu-client"]=this["webpackJsonpihearu-client"]||[]).push([[0],{407:function(e,n,t){},414:function(e,n,t){},420:function(e,n){},421:function(e,n){},429:function(e,n){},439:function(e,n){},440:function(e,n){},441:function(e,n){},449:function(e,n){},521:function(e,n,t){"use strict";t.r(n);var a=t(11),c=t.n(a),r=t(64),o=t.n(r),i=(t(407),t(4)),s=t.n(i),l=t(12),u=t(5),d=t(135),h=(t(414),t(364)),f=t.n(h),p=t(563),j=t(564),b=t(287),g=t(559),m=t(390),O=t.n(m),v=t(561),x=t(566),w=t(560),k=t(555),y=t(556),S=t(554),C=t(567),A=t(558),W=t(568),N=t(195),L={settings:{threshold:85,showStats:!1,speakAlong:!0},sentence:{predictions:[],words:[],log:[]}},H=Object(N.b)({name:"settings",initialState:L.settings,reducers:{setThreshold:function(e,n){e.threshold=n.payload},setShowStats:function(e,n){e.showStats=n.payload},setSpeakAlong:function(e,n){e.speakAlong=n.payload}}}),T=Object(N.b)({name:"sentence",initialState:L.sentence,reducers:{addPrediction:function(e,n){e.predictions.push(n.payload)},addWord:function(e,n){e.predictions=[],e.words.push(n.payload)},logWords:function(e){e.log.unshift(e.words),e.words=[]}}}),F=(H.reducer,Object(N.a)({reducer:{settings:H.reducer,sentence:T.reducer}})),P=F.getState,U=F.dispatch,E=t(557),I=t(39);function R(e){return"".concat(e,"%")}function B(e){var n=e.open,t=e.handleClose,a=Object(d.c)((function(e){return e.settings})),c=Object(d.b)();return Object(I.jsx)("div",{children:Object(I.jsxs)(x.a,{fullWidth:!0,maxWidth:"sm",open:n,onClose:t,"aria-labelledby":"settings-dialog-title",children:[Object(I.jsx)(S.a,{id:"settings-dialog-title",children:"Settings"}),Object(I.jsx)(k.a,{children:Object(I.jsx)(y.a,{children:Object(I.jsxs)(E.a,{children:[Object(I.jsx)(A.a,{control:Object(I.jsx)(C.a,{value:a.threshold,getAriaValueText:R,"aria-labelledby":"threshold-slider",valueLabelDisplay:"auto",step:5,marks:!0,min:50,max:99,onChange:function(e,n){return c(H.actions.setThreshold(n))}}),label:"Accuracy threshold",labelPlacement:"top"}),Object(I.jsx)(A.a,{control:Object(I.jsx)(W.a,{checked:a.showStats,onChange:function(e){return c(H.actions.setShowStats(e.target.checked))},name:"showStats",color:"primary"}),label:"Show Stats"}),Object(I.jsx)(A.a,{control:Object(I.jsx)(W.a,{checked:a.speakAlong,onChange:function(e){return c(H.actions.setSpeakAlong(e.target.checked))},name:"showStats",color:"primary"}),label:"Speak along signing"})]})})}),Object(I.jsx)(w.a,{children:Object(I.jsx)(v.a,{autoFocus:!0,onClick:t,color:"primary",children:"Close"})})]})})}var D,z=t(20),J=t(388),M=t(387),V=t(285),$=[],q=[],G=[],K=[],Q=[],X=new Array(63).fill(0),Y=function(e){return e.reduce((function(e,n){return e.concat([n.x,n.y,n.z])}),[])};function Z(){return _.apply(this,arguments)}function _(){return(_=Object(l.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"model/model.json",e.next=3,V.a("model/model.json");case 3:D=e.sent;case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ee(){return ne.apply(this,arguments)}function ne(){return(ne=Object(l.a)(s.a.mark((function e(){var n,t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/model.csv");case 2:return n=e.sent,e.next=5,n.text();case 5:t=e.sent,$=t.split(",");case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(e){return ae.apply(this,arguments)}function ae(){return(ae=Object(l.a)(s.a.mark((function e(n){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new M.Hands({locateFile:function(e){return"/hands/".concat(e)}})).setOptions({maxNumHands:2,minDetectionConfidence:.5,minTrackingConfidence:.5}),t.onResults(ce),e.next=5,t.initialize();case 5:n&&new J.Camera(n,{onFrame:function(){var e=Object(l.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.send({image:n});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}).start();case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ce(e){if(function(e){if(e.multiHandLandmarks&&e.multiHandedness){for(var n=X,t=X,a=0;a<e.multiHandLandmarks.length;a++){var c="Right"===e.multiHandedness[a].label,r=e.multiHandLandmarks[a];c?t=Y(r):n=Y(r)}q=[].concat(Object(z.a)(n),Object(z.a)(t)),G.push(q)}}(e),2===G.length){var n=function(e){var n=V.b([e]),t=D.predict(n).dataSync(),a=Math.max.apply(Math,Object(z.a)(t)),c=Object(z.a)(t).indexOf(a);return a>=P().settings.threshold/100?(console.log($[c],a),$[c]):null}(G),t=n!==Q[Q.length-1],a=K.length>4&&n===(c=K).sort((function(e,n){return c.filter((function(n){return n===e})).length-c.filter((function(e){return e===n})).length})).pop();if(n&&(K.push(n),U(T.actions.addPrediction(n))),n&&t&&a)if(Q.push(n),K=[],U(T.actions.addWord(n)),P().settings.speakAlong)try{new Audio("/audio/".concat(n,".mp3")).play()}catch(r){}G=[]}var c}function re(){U(T.actions.logWords()),Q=[]}function oe(e){return e.reduce((function(e,n){return n in e?e[n]++:e[n]=1,e}),{})}var ie=t(565),se=t(391),le=t.n(se),ue=t(562),de=t(392),he=t(389),fe=t.n(he),pe=Object(de.a)({palette:{primary:{light:"#ffce42",main:"#ffbd00",dark:"#bd8c00",contrastText:"#fff"}}});var je=function(){var e=Object(a.useRef)(null),n=c.a.useState(!1),t=Object(u.a)(n,2),r=t[0],o=t[1],i=c.a.useState(!0),h=Object(u.a)(i,2),m=h[0],v=h[1],x=Object(d.c)((function(e){return e.settings})),w=Object(d.c)((function(e){return e.sentence}));return Object(a.useEffect)((function(){(function(){var n=Object(l.a)(s.a.mark((function n(){var t,a;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,ee();case 2:return n.next=4,Z();case 4:if(!(null===(t=e.current)||void 0===t?void 0:t.video)){n.next=7;break}return n.next=7,te(null===(a=e.current)||void 0===a?void 0:a.video);case 7:v(!1);case 8:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}})()()}),[]),Object(I.jsxs)(ue.a,{theme:pe,children:[Object(I.jsx)(p.a,{position:"static",children:Object(I.jsxs)(j.a,{className:"appbar-toolbar",children:[Object(I.jsxs)("div",{className:"appbar-toolbar--title",children:[Object(I.jsx)("img",{src:"/favicon.ico",alt:"logo"}),Object(I.jsx)(b.a,{variant:"h6",children:"IHearU"})]}),Object(I.jsx)(g.a,{edge:"end","aria-label":"settings","aria-haspopup":"true",color:"inherit",onClick:function(){o(!0)},children:Object(I.jsx)(O.a,{})})]})}),Object(I.jsxs)("div",{className:"App-body",children:[!m&&x.showStats&&Object(I.jsx)("div",{className:"stats",children:Object(I.jsx)("div",{children:Object.keys(oe(w.predictions)).map((function(e){return Object(I.jsxs)("span",{children:[e,": ",oe(w.predictions)[e]," "]},e)}))})}),Object(I.jsx)(f.a,{ref:e,style:{display:m?"none":"block"}}),Object(I.jsx)(B,{open:r,handleClose:function(){o(!1)}}),m&&Object(I.jsxs)("div",{className:"loading-scrim",children:[Object(I.jsx)("img",{src:"/logo192.png",alt:"IHearU Logo",className:"App-logo"}),Object(I.jsx)("h3",{children:"Loading detection models"}),Object(I.jsx)(ie.a,{})]}),!m&&Object(I.jsxs)("div",{className:"word-container",children:[Object(I.jsxs)("div",{className:"typewriter-container",children:[Object(I.jsx)(fe.a,{typing:1,children:w.words.join(" ")}),Object(I.jsx)(g.a,{edge:"end","aria-label":"settings","aria-haspopup":"true",color:"primary",onClick:re,disabled:0===w.words.length,children:Object(I.jsx)(le.a,{})})]}),Object(I.jsx)("div",{className:"word-log",children:w.log.map((function(e,n){return Object(I.jsxs)("p",{children:[e.join(" ")," "]},"".concat(e,"-").concat(n))}))})]})]})]})},be=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ge(e,n){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),n&&n.onUpdate&&n.onUpdate(e)):(console.log("Content is cached for offline use."),n&&n.onSuccess&&n.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var me=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,569)).then((function(n){var t=n.getCLS,a=n.getFID,c=n.getFCP,r=n.getLCP,o=n.getTTFB;t(e),a(e),c(e),r(e),o(e)}))};o.a.render(Object(I.jsx)(d.a,{store:F,children:Object(I.jsx)(je,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var n="".concat("","/service-worker.js");be?(!function(e,n){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(t){var a=t.headers.get("content-type");404===t.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):ge(e,n)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(n,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):ge(n,e)}))}}(),me()}},[[521,1,2]]]);
//# sourceMappingURL=main.8c721ac5.chunk.js.map