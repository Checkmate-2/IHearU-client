(this["webpackJsonpihearu-client"]=this["webpackJsonpihearu-client"]||[]).push([[0],{434:function(e,n,t){},441:function(e,n,t){},506:function(e,n){},507:function(e,n){},515:function(e,n){},525:function(e,n){},526:function(e,n){},527:function(e,n){},535:function(e,n){},624:function(e,n,t){"use strict";t.r(n);var r=t(17),a=t.n(r),c=t(75),o=t.n(c),i=(t(434),t(4)),s=t.n(i),l=t(11),u=t(5),d=t(132),h=(t(441),t(388)),f=t.n(h),p=t(422),j=t.n(p),b=t(423),g=t.n(b),m=t(187),v=t.n(m),x=t(249),O=t.n(x),w=t(424),k=t.n(w),y=t(396),S=t.n(y),C=t(389),W=t.n(C),A=t(395),T=t.n(A),L=t(391),N=t.n(L),H=t(392),P=t.n(H),F=t(390),U=t.n(F),E=t(394),I=t.n(E),R=t(260),B=t.n(R),D=t(294),z=t.n(D),J=t(195),M={settings:{threshold:85,showStats:!1,speakAlong:!0},sentence:{predictions:[],words:[],log:[]}},V=Object(J.b)({name:"settings",initialState:M.settings,reducers:{setThreshold:function(e,n){e.threshold=n.payload},setShowStats:function(e,n){e.showStats=n.payload},setSpeakAlong:function(e,n){e.speakAlong=n.payload}}}),$=Object(J.b)({name:"sentence",initialState:M.sentence,reducers:{addPrediction:function(e,n){e.predictions.push(n.payload)},addWord:function(e,n){e.predictions=[],e.words.push(n.payload)},logWords:function(e){e.log.unshift(e.words),e.words=[]}}}),q=(V.reducer,Object(J.a)({reducer:{settings:V.reducer,sentence:$.reducer}})),G=q.getState,K=q.dispatch,Q=t(393),X=t.n(Q),Y=t(41);function Z(e){return"".concat(e,"%")}function _(e){var n=e.open,t=e.handleClose,r=Object(d.c)((function(e){return e.settings})),a=Object(d.b)();return Object(Y.jsx)("div",{children:Object(Y.jsxs)(W.a,{fullWidth:!0,maxWidth:"sm",open:n,onClose:t,"aria-labelledby":"settings-dialog-title",children:[Object(Y.jsx)(U.a,{id:"settings-dialog-title",children:"Settings"}),Object(Y.jsx)(N.a,{children:Object(Y.jsx)(P.a,{children:Object(Y.jsxs)(X.a,{children:[Object(Y.jsx)(B.a,{control:Object(Y.jsx)(I.a,{value:r.threshold,getAriaValueText:Z,"aria-labelledby":"threshold-slider",valueLabelDisplay:"auto",step:5,marks:!0,min:50,max:99,onChange:function(e,n){return a(V.actions.setThreshold(n))}}),label:"Accuracy threshold",labelPlacement:"top"}),Object(Y.jsx)(B.a,{control:Object(Y.jsx)(z.a,{checked:r.showStats,onChange:function(e){return a(V.actions.setShowStats(e.target.checked))},name:"showStats",color:"primary"}),label:"Show Stats"}),Object(Y.jsx)(B.a,{control:Object(Y.jsx)(z.a,{checked:r.speakAlong,onChange:function(e){return a(V.actions.setSpeakAlong(e.target.checked))},name:"showStats",color:"primary"}),label:"Speak along signing"})]})})}),Object(Y.jsx)(T.a,{children:Object(Y.jsx)(S.a,{autoFocus:!0,onClick:t,color:"primary",children:"Close"})})]})})}var ee,ne,te=t(20),re=t(420),ae=t(419),ce=t(296),oe=[],ie=[],se=[],le=[],ue=[],de=new Array(63).fill(0),he=function(e){return e.reduce((function(e,n){return e.concat([n.x,n.y,n.z])}),[])};function fe(){return pe.apply(this,arguments)}function pe(){return(pe=Object(l.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"model/model.json",e.next=3,ce.a("model/model.json");case 3:ee=e.sent;case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function je(){return be.apply(this,arguments)}function be(){return(be=Object(l.a)(s.a.mark((function e(){var n,t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/model.csv");case 2:return n=e.sent,e.next=5,n.text();case 5:return t=e.sent,oe=t.split(","),e.next=9,ge();case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ge(){return me.apply(this,arguments)}function me(){return(me=Object(l.a)(s.a.mark((function e(){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/franco.json");case 2:return n=e.sent,e.next=5,n.json();case 5:ne=e.sent;case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ve(e){return xe.apply(this,arguments)}function xe(){return(xe=Object(l.a)(s.a.mark((function e(n){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new ae.Hands({locateFile:function(e){return"/hands/".concat(e)}})).setOptions({maxNumHands:2,minDetectionConfidence:.5,minTrackingConfidence:.5}),t.onResults(Oe),e.next=5,t.initialize();case 5:n&&new re.Camera(n,{onFrame:function(){var e=Object(l.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.send({image:n});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}).start();case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Oe(e){if(function(e){if(e.multiHandLandmarks&&e.multiHandedness){for(var n=de,t=de,r=0;r<e.multiHandLandmarks.length;r++){var a="Right"===e.multiHandedness[r].label,c=e.multiHandLandmarks[r];a?t=he(c):n=he(c)}ie=[].concat(Object(te.a)(n),Object(te.a)(t)),se.push(ie)}}(e),2===se.length){var n=function(e){var n=ce.b([e]),t=ee.predict(n).dataSync(),r=Math.max.apply(Math,Object(te.a)(t)),a=Object(te.a)(t).indexOf(r);return r>=G().settings.threshold/100?(console.log(oe[a],r),oe[a]):null}(se),t=n!==ue[ue.length-1],r=le.length>4&&n===(a=le).sort((function(e,n){return a.filter((function(n){return n===e})).length-a.filter((function(e){return e===n})).length})).pop();if(n&&(le.push(n),K($.actions.addPrediction(n))),n&&t&&r)ue.push(n),le=[],K($.actions.addWord(n)),G().settings.speakAlong&&speechSynthesis.speak(new SpeechSynthesisUtterance(ne[n]));se=[]}var a}function we(){var e=G().sentence.words.map((function(e){return ne[e]}));speechSynthesis.speak(new SpeechSynthesisUtterance(e.join(" "))),K($.actions.logWords()),ue=[]}function ke(e){return e.reduce((function(e,n){return n in e?e[n]++:e[n]=1,e}),{})}var ye=t(425),Se=t.n(ye),Ce=t(426),We=t.n(Ce),Ae=t(259),Te=t(421),Le=t.n(Te),Ne=Object(Ae.createTheme)({palette:{primary:{light:"#ffce42",main:"#ffbd00",dark:"#bd8c00",contrastText:"#fff"}}});var He=function(){var e=Object(r.useRef)(null),n=a.a.useState(!1),t=Object(u.a)(n,2),c=t[0],o=t[1],i=a.a.useState(!0),h=Object(u.a)(i,2),p=h[0],b=h[1],m=Object(d.c)((function(e){return e.settings})),x=Object(d.c)((function(e){return e.sentence}));return Object(r.useEffect)((function(){(function(){var n=Object(l.a)(s.a.mark((function n(){var t,r;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,je();case 2:return n.next=4,fe();case 4:if(!(null===(t=e.current)||void 0===t?void 0:t.video)){n.next=7;break}return n.next=7,ve(null===(r=e.current)||void 0===r?void 0:r.video);case 7:b(!1);case 8:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}})()()}),[]),Object(Y.jsxs)(Ae.ThemeProvider,{theme:Ne,children:[Object(Y.jsx)(j.a,{position:"static",children:Object(Y.jsxs)(g.a,{className:"appbar-toolbar",children:[Object(Y.jsxs)("div",{className:"appbar-toolbar--title",children:[Object(Y.jsx)("img",{src:"/favicon.ico",alt:"logo"}),Object(Y.jsx)(v.a,{variant:"h6",children:"IHearU"})]}),Object(Y.jsx)(O.a,{edge:"end","aria-label":"settings","aria-haspopup":"true",color:"inherit",onClick:function(){o(!0)},children:Object(Y.jsx)(k.a,{})})]})}),!p&&m.showStats&&Object(Y.jsx)("div",{className:"stats",children:Object(Y.jsx)("div",{children:Object.keys(ke(x.predictions)).map((function(e){return Object(Y.jsxs)("span",{children:[e,": ",ke(x.predictions)[e]," "]},e)}))})}),Object(Y.jsx)(f.a,{ref:e,style:{display:p?"none":"block"}}),Object(Y.jsx)(_,{open:c,handleClose:function(){o(!1)}}),p&&Object(Y.jsxs)("div",{className:"loading-scrim",children:[Object(Y.jsx)("img",{src:"/logo192.png",alt:"IHearU Logo",className:"App-logo"}),Object(Y.jsx)("h3",{children:"Loading detection models"}),Object(Y.jsx)(Se.a,{})]}),Object(Y.jsxs)("div",{className:"typewriter-container",children:[Object(Y.jsx)(Le.a,{typing:1,children:x.words.join(" ")}),Object(Y.jsx)(O.a,{edge:"end","aria-label":"settings","aria-haspopup":"true",color:"primary",onClick:we,disabled:0===x.words.length,children:Object(Y.jsx)(We.a,{})})]}),Object(Y.jsx)("div",{className:"word-log",children:x.log.map((function(e,n){return Object(Y.jsxs)("p",{children:[e.join(" ")," "]},"".concat(e,"-").concat(n))}))})]})},Pe=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Fe(e,n){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),n&&n.onUpdate&&n.onUpdate(e)):(console.log("Content is cached for offline use."),n&&n.onSuccess&&n.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var Ue=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,626)).then((function(n){var t=n.getCLS,r=n.getFID,a=n.getFCP,c=n.getLCP,o=n.getTTFB;t(e),r(e),a(e),c(e),o(e)}))};o.a.render(Object(Y.jsx)(d.a,{store:q,children:Object(Y.jsx)(He,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var n="".concat("","/service-worker.js");Pe?(!function(e,n){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(t){var r=t.headers.get("content-type");404===t.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Fe(e,n)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(n,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):Fe(n,e)}))}}(),Ue()}},[[624,1,2]]]);
//# sourceMappingURL=main.891c32a9.chunk.js.map